name: 'Run Revyl Test'
description: 'Run a Revyl test or workflow with real-time monitoring'
author: 'Revyl'

# Define your inputs here.
inputs:
  workflow-id:
    description: 'The workflow id to run.'
    required: false
  test-id:
    description: 'The test id to run.'
    required: false
  retries:
    description: 'The number of times to retry the test.'
    required: false
  build-version-id:
    description:
      'Optional build version ID to use for this test execution. Overrides the
      build version attached to the test.'
    required: false
  timeout:
    description:
      'Timeout in seconds for the execution to complete. Default 3600.'
    required: false
  revyl-device-url:
    description:
      'Override device base URL (e.g., https://device-staging.revyl.ai)'
    required: false
  backend-url:
    description:
      'Override backend base URL (e.g., https://backend-staging.revyl.ai)'
    required: false
  no-wait:
    description:
      'If true, launch the test/workflow and exit immediately after it starts
      without waiting for completion. The action succeeds as long as the
      execution was successfully queued.'
    required: false
    default: 'false'
  start-timeout:
    description:
      'Timeout in seconds to wait for the test/workflow to start (only used
      with no-wait mode). Default 60.'
    required: false
    default: '60'

# Define your outputs here.
outputs:
  success:
    description: 'Whether or not the test/workflow succeeded.'
  task_id:
    description: 'The task identifier returned by the async API.'
  execution_time:
    description: 'Total execution time reported by the platform.'
  platform:
    description: 'Execution platform (web, ios, android).'
  error_message:
    description: 'Error message if execution failed.'
  report_link:
    description: 'Shareable link to the detailed test execution report.'
  # Workflow-specific outputs
  total_tests:
    description: 'Total number of tests in the workflow.'
  completed_tests:
    description: 'Number of tests completed in the workflow.'
  passed_tests:
    description: 'Number of tests that passed in the workflow.'
  failed_tests:
    description: 'Number of tests that failed in the workflow.'
  # Test-specific outputs
  total_steps:
    description: 'Total number of steps in the test.'
  completed_steps:
    description: 'Number of steps completed in the test.'
runs:
  using: node20
  main: dist/index.js
